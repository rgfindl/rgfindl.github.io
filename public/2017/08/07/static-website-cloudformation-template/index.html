<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Static Website CloudFormation Template | Randy Findley</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/css/app.css">
  
</head>

<body>
  <nav class="app-nav">
  
    
      <a href="/.">home</a>
    
  
    
      <a href="/archives">archive</a>
    
  
    
      <a href="/atom.xml">rss</a>
    
  
</nav>

  <main class="post">
  <article>
  <h1 class="article-title">
    <a href="/2017/08/07/static-website-cloudformation-template/">Static Website CloudFormation Template</a>
  </h1>

  <section class="article-meta">
    <p class="article-date">August 07 2017</p>
  </section>

  <section class="article-entry">
    <p>The template: <a href="https://s3.amazonaws.com/thestackshack/static.website.cloudformation.json" target="_blank" rel="external">static.website.cloudformation.json</a></p>
<h3 id="Click-here-to-launch-your-static-website-on-AWS"><a href="#Click-here-to-launch-your-static-website-on-AWS" class="headerlink" title="Click here to launch your static website on AWS"></a>Click here to launch your static website on AWS</h3><a href="https://console.aws.amazon.com/cloudformation/home?region=us-east-1#/stacks/new?stackName=staticwebsite&templateURL=https://s3.amazonaws.com/thestackshack/static.website.cloudformation.json" target="_blank" rel="external">{% raw %}<img src="https://s3.amazonaws.com/cloudformation-examples/cloudformation-launch-stack.png"></a>{% endraw %}
<h3 id="What-is-a-static-website-and-why-are-they-cool"><a href="#What-is-a-static-website-and-why-are-they-cool" class="headerlink" title="What is a static website and why are they cool?"></a>What is a static website and why are they cool?</h3><p>A static website is simply html, css, js,… files hosted by AWS S3.  They are cool because there are no servers for you to maintain and pay for.  You only pay for the storage of your files and the amount of traffic your site gets.  Security is greatly improved because your site has no servers or databases to hack into.</p>
<h3 id="What-AWS-resources-does-this-template-use"><a href="#What-AWS-resources-does-this-template-use" class="headerlink" title="What AWS resources does this template use?"></a>What AWS resources does this template use?</h3><ul>
<li>S3 (File storage &amp; static website)</li>
<li>CloudFront (HTTPS &amp; caching)</li>
<li>Certificate Manager (SSL Cert)</li>
<li>Route53 (DNS)</li>
<li>CodeBuild (Continuous deployment)</li>
<li>CodePipeline (Continuous deployment)</li>
<li>CodeCommit (GIT repo)</li>
<li>CloudFormation (Infrastructure as Code)</li>
<li>IAM (AWS permissions &amp; users)</li>
</ul>
<p>This seems like a lot just to host a static website!  Yep, it is, that’s why I created this handy CloudFormation template so the next time I want to stand up a <em>simple</em> static website I just have to click the button above.</p>
<h3 id="How-do-I-get-started"><a href="#How-do-I-get-started" class="headerlink" title="How do I get started?"></a>How do I get started?</h3><h4 id="Step-1-Create-your-AWS-account"><a href="#Step-1-Create-your-AWS-account" class="headerlink" title="Step 1 - Create your AWS account"></a>Step 1 - Create your AWS account</h4><p>The first step is to create an {% raw %}<a href="https://aws.amazon.com" target="_blank" rel="external">AWS account</a>{% endraw %}.</p>
<h4 id="Step-2-Create-your-IAM-user"><a href="#Step-2-Create-your-IAM-user" class="headerlink" title="Step 2 - Create your IAM user"></a>Step 2 - Create your IAM user</h4><p>Once you’re logged into your account you need to create an {% raw %}<a href="https://console.aws.amazon.com/iam/home" target="_blank" rel="external">IAM user</a>{% endraw %} with <strong>Programmatic access</strong>, and with <strong>AWSCodeCommitFullAccess</strong> &amp; <strong>AdministratorAccess</strong> permissions.  Also, your user will need CodeCommit (GIT) credentials.  Don’t forget to download all of your credentials because you’ll need then later.  See the screen shots below:<br>{% raw %}<img src="/images/aws-permissions.png">{% endraw %}<br>{% raw %}<img src="/images/aws-git-credentials.png">{% endraw %}</p>
<h4 id="Step-3-Purchase-your-domain-name"><a href="#Step-3-Purchase-your-domain-name" class="headerlink" title="Step 3 - Purchase your domain name"></a>Step 3 - Purchase your domain name</h4><p>Head on over to {% raw %}<a href="https://console.aws.amazon.com/route53/home" target="_blank" rel="external">Route 53</a>{% endraw %} and register your domain name.  If you already have a domain name, don’t worry, you can point it at Route53 after you build the stack. </p>
<h4 id="Step-4-Build-the-stack"><a href="#Step-4-Build-the-stack" class="headerlink" title="Step 4 - Build the stack"></a>Step 4 - Build the stack</h4><p>Click on the buttom at the top to build the stack.  Use your domain name and app name as the input parameters.</p>
<p>You can also copy the cloudformation template and install the stack using the {% raw %}<a href="http://docs.aws.amazon.com/cli/latest/userguide/installing.html" target="_blank" rel="external">AWS command-line tools</a>{% endraw %}.  Harder but recommended.  You should really version control your IaC template as well as your code.  Here are the commands to create, update, and delete the stack.</p>
<p><strong>Create Stack</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">aws cloudformation create-stack \</div><div class="line">--stack-name &lt;example-com&gt; \</div><div class="line">--template-body file:///&lt;abs_path&gt;/static.website.cloudformation.json \</div><div class="line">--parameters ParameterKey=ApexDomainName,ParameterValue=&lt;example.com&gt; ParameterKey=AppName,ParameterValue=&lt;example&gt; \</div><div class="line">--tags=Key=app,Value=&lt;example.com&gt; \</div><div class="line">--capabilities CAPABILITY_IAM \</div><div class="line">--profile &lt;profile&gt;</div></pre></td></tr></table></figure></p>
<p><strong>Delete Stack</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">aws cloudformation delete-stack \</div><div class="line">--stack-name &lt;example-com&gt; \</div><div class="line">--profile &lt;profile&gt;</div></pre></td></tr></table></figure></p>
<p><strong>Update Stack</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">aws cloudformation update-stack \</div><div class="line">--stack-name &lt;example-com&gt; \</div><div class="line">--template-body file:///&lt;abs_path&gt;/static.website.cloudformation.json \</div><div class="line">--parameters ParameterKey=ApexDomainName,ParameterValue=&lt;example.com&gt; ParameterKey=AppName,ParameterValue=&lt;example&gt; \</div><div class="line">--tags=Key=app,Value=&lt;example.com&gt; \</div><div class="line">--capabilities CAPABILITY_IAM \</div><div class="line">--profile &lt;profile&gt;</div></pre></td></tr></table></figure></p>
<h4 id="Step-5-Validate-domain-ownership"><a href="#Step-5-Validate-domain-ownership" class="headerlink" title="Step 5 - Validate domain ownership"></a>Step 5 - Validate domain ownership</h4><p>When AWS Certificate Manager creates your SSL certificate it sends and email to the domain name administrator (You).  You have to get that email and click the confirmation link.  Once this step has been completed the stack can continue being built.  More information can be found here:  <a href="http://docs.aws.amazon.com/acm/latest/userguide/gs-acm-validate.html" target="_blank" rel="external">http://docs.aws.amazon.com/acm/latest/userguide/gs-acm-validate.html</a></p>
<h4 id="Step-6-Wait-for-your-stack-to-be-built"><a href="#Step-6-Wait-for-your-stack-to-be-built" class="headerlink" title="Step 6 - Wait for your stack to be built"></a>Step 6 - Wait for your stack to be built</h4><p>Check the progress of your stack here:  <a href="https://console.aws.amazon.com/cloudformation/home" target="_blank" rel="external">https://console.aws.amazon.com/cloudformation/home</a></p>
<p>Once your stack has been built copy the output param which will be your CodeCommit repo URL.  </p>
<h3 id="What-do-I-do-after-my-stack-has-been-created"><a href="#What-do-I-do-after-my-stack-has-been-created" class="headerlink" title="What do I do after my stack has been created?"></a>What do I do after my stack has been created?</h3><p>Use your CodeCommit repo and your CodeCommit credentials to start checking in your static site.</p>
<p>CodePipeline and CodeBuild are setup to continuously deploy your site as you push changes to your repo.  </p>
<p>Branches and CodePipeline actions:<br><strong>master</strong> -&gt; Pushes changes to APEX <example.com> (yes ssl)<br><strong>develop</strong> -&gt; Pushes changes to dev subdomain (no ssl)</example.com></p>

  </section>
</article>

  <div class="sharing grid">
  <section class="profile grid-item grid">
    <img class="avatar" src="https://media.licdn.com/mpr/mpr/shrinknp_400_400/p/3/005/062/05d/36bc6ef.jpg" alt="avatar" />
    <div class="grid-item">
      <p class="title"> Randy Findley </p>
      <p class="subtitle"> An Engineering Blog </p>
    <div>
  </section>

  <section class="share-btns">
    <!-- <p> share it if you like it~ </p> -->
    <a
  class="twitter-share-button"
  data-size="large"
  data-via="rgfindl"
  href="https://twitter.com/intent/tweet?text=The template: <a hre"
>

</a>

<script>
  window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  js.async = true;
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));
</script>

  </section>
</div>


  
    
<section class="article-comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

<script>
  var disqus_shortname = 'rgfindl-github-io';
  
  var disqus_url = 'https://rgfindl.github.io/2017/08/07/static-website-cloudformation-template/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


  
</main>

</body>
</html>
